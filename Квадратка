#include <stdio.h>
#include <math.h>
#include <string.h>


void get_cofficient (double *out, char sym);
void get_cofficients (double *a, double *b, double *c);
int SolveQuadratic (double a, double b, double c, double *x1, double *x2);
int CalculateSquare (double a, double b, double c, double *x1, double *x2);
int CalculateLineal (double b, double c, double *x1);
void PrintRoots (int NRoots, double *x1, double *x2);
int TestCheck (int TestNumber, double a, double b, double c, double correct_x1, double correct_x2, int correct_NRoots);
char *AllTestCheck (void);

int main(void)
{
//    double a = 0, b = 0, c = 0;
//    get_cofficients(&a, &b, &c);
//
//    double x1 = 0, x2 = 0;// Roots
//    int NRoots = SolveQuadratic (a, b, c, &x1, &x2);// Amount of roots
//
//    PrintRoots (NRoots, &x1, &x2);

    printf("%s", AllTestCheck ());
    return 0;
}

void get_cofficient (double *out, char sym)
{
    printf ("%c = ", sym);
    while (scanf ("%lf", out) != 1)
    {
        printf("Error, try again \n");
        printf ("%c = ", sym);
        while (getchar() != '\n')
            ;

    }
}

void get_cofficients (double *a, double *b, double *c)
{
    get_cofficient(a, 'a');
    get_cofficient(b, 'b');
    get_cofficient(c, 'c');
}

int SolveQuadratic (double a, double b, double c, double *x1, double *x2)
{
    if (a == 0)
    {
        return CalculateLineal (b, c, x1);
    }
    else
    {
        return CalculateSquare (a, b, c, x1, x2);
    }
}

int CalculateLineal (double b, double c, double *x1)
{
    if (b == 0)
        return -1; // infinity
    else
        *x1 = -c / b;
        return 1; //not a quadratic equation, lineal
}

int CalculateSquare (double a, double b, double c, double *x1, double *x2)
{
    double d = 0; // discriminant
    d = b * b - 4 * a * c;

    if (d == 0)
    {
        *x1 = -b / (2 * a);

        return 1;// 1 root
    }

    else if (d > 0)
    {
        *x1 = (-b + sqrt(d)) / (2 * a);
        *x2 = (-b - sqrt(d)) / (2 * a);

        return 2;
    }

    else
        return 0; // no roots
}

void PrintRoots (int NRoots, double *x1, double *x2)
{
    switch (NRoots)
    {
        case -1 :
            printf ("Infinity roots");
            break;

        case 0 :
            printf ("No roots");
            break;

        case 1 :
            printf ("One root : x1 = ");
            printf ("%f", *x1);
            break;

        case 2:
            printf ("First root : x1 = %f ", *x1);
            printf ("Second root : x2 = %f", *x2);
            break;

        default :
            printf ("ERROR");
    }
}

int TestCheck (int TestNumber, double a, double b, double c, double correct_x1, double correct_x2, int correct_NRoots)
{
    double x1 = 0, x2 = 0;
    int NRoots = SolveQuadratic (a, b, c, &x1, &x2);
    if (NRoots != correct_NRoots || x1 != correct_x1 || x2 != correct_x2)
    {
        printf ("Error test %d, a = %lf, b = %lf, c = %lf, x1 = %lf, x2 = %lf, NRoots = %lf, correct_x1 = %lf, correct_x2 = %lf, correct_NRoots = %lf",
                TestNumber, a, b, c, x1, x2, NRoots, correct_x1, correct_x2, correct_NRoots);
        return -1;
    }
    else
        return 1;

}

char *AllTestCheck (void)
{

    if (
    TestCheck (1, 2, 3, -5, 1, -2.5, 2) &&
    TestCheck (2, 0, 0, -5, 0, 0, -1) &&
    TestCheck (3, 0, 3, 6, -2, 0, 1)
        )
        printf("Success");

}


